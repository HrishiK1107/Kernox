============================================================
  KERNOX eBPF ENDPOINT AGENT â€” PROGRESS UPDATE
  Date: 15 Feb 2026
  Branch: feature/ebpf-agent
============================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 âœ…  COMPLETED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. PROJECT SETUP
   â€¢ Python package structure (agent/)
   â€¢ Configuration module (endpoint ID, backend URL, intervals)
   â€¢ .gitignore, Git repo initialized
   â€¢ Pushed to https://github.com/aaryaman005/Kernox.git
   â€¢ Branches: main, develop, feature/ebpf-agent

2. PROCESS MONITORING (Feature 1)
   â€¢ eBPF C program hooking sys_enter_execve & sched_process_exit
   â€¢ Captures PID, PPID, UID, GID, comm, filename
   â€¢ Per-CPU array scratch space (avoids BPF 512-byte stack limit)
   â€¢ Python BCC loader with ctypes struct mapping

3. PROCESS LINEAGE TRACKING (Feature 2)
   â€¢ Thread-safe in-memory DAG (parentâ†’child)
   â€¢ Ancestor chain queries for attack graph building
   â€¢ Auto-pruning of dead leaf processes

4. FILE ACTIVITY MONITORING (Feature 3)
   â€¢ eBPF hooks: openat, write, renameat2
   â€¢ Ransomware burst detection (20+ writes in 5 seconds â†’ HIGH alert)

5. NETWORK ACTIVITY MONITORING (Feature 4)
   â€¢ eBPF kprobe: tcp_connect
   â€¢ Captures dest IP, port, responsible process
   â€¢ C2 beaconing detection (10+ connects to same IP in 60s â†’ HIGH alert)

6. PRIVILEGE ESCALATION DETECTION (Feature 5)
   â€¢ eBPF hooks: sys_enter_setuid, sys_enter_setgid
   â€¢ Escalation to root (uid 0) â†’ CRITICAL severity

7. EVENT STREAMING (Feature 8 â€” Phase 1)
   â€¢ JSON event enrichment (timestamp, hostname, endpoint_id, lineage)
   â€¢ stdout output (ready for HTTP backend integration)

8. AGENT HEALTH & HEARTBEAT (Feature 10)
   â€¢ Background thread, 30-second interval
   â€¢ Reports uptime, system info, event stats, tracked processes

9. RESPONSE EXECUTION HOOK (Feature 9)
   â€¢ Kill process (SIGKILL)
   â€¢ Block IP (iptables INPUT+OUTPUT DROP)
   â€¢ Isolate host (whitelist backend only)
   â€¢ Quarantine file (move to /var/kernox/quarantine/)
   â€¢ Full rollback support for all actions
   â€¢ Transaction audit log

10. BUG FIX: SHUTDOWN CRASH
    â€¢ Added shutdown guards to all 4 eBPF monitor callbacks
    â€¢ Prevents segfault when Ctrl+C fires during active perf buffer polling

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸ”²  NEXT STEPS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. BACKEND (Layer 2 â€” Hrishikesh's scope)
   â€¢ FastAPI server with event ingestion API (/api/v1/events)
   â€¢ PostgreSQL database for event storage
   â€¢ Pydantic models for incoming event data

2. AGENT â†’ BACKEND HTTP STREAMING
   â€¢ Replace stdout JSON output with HTTP POST to backend
   â€¢ Retry logic, connection pooling, buffering

3. DETECTION ENGINE (Layer 5)
   â€¢ YARA rule matching
   â€¢ Sigma rule integration
   â€¢ ML-based anomaly scoring

4. SOAR AUTOMATION (Layer 6)
   â€¢ Playbook engine triggered by detection alerts
   â€¢ Auto-response via ResponseHook (kill, block, isolate)

5. DASHBOARD (Layer 7)
   â€¢ Real-time event feed (WebSocket)
   â€¢ Process lineage visualization
   â€¢ Alert management UI

6. REMAINING AGENT FEATURES
   â€¢ DNS query monitoring
   â€¢ Container-aware process tracking
   â€¢ Log tampering detection

============================================================
